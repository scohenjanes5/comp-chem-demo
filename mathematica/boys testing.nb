(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16335,        455]
NotebookOptionsPosition[     15073,        425]
NotebookOutlinePosition[     15477,        441]
CellTagsIndexPosition[     15434,        438]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolyX", "[", 
    RowBox[{
    "alpha_", ",", "beta_", ",", "RA_", ",", "RB_", ",", "RR_", ",", "LA_", 
     ",", "LB_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eta", ",", "EAB"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"intial", " ", "conditions", " ", "for", " ", "eta"}], "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eta", "[", 
           RowBox[{"i_", ",", "0", ",", "0"}], "]"}], ":=", "1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eta", "[", 
           RowBox[{"i_", ",", "1", ",", "0"}], "]"}], ":=", 
          "\[IndentingNewLine]", 
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"RA", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"alpha", "*", 
                  RowBox[{"RA", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                 RowBox[{"beta", "*", 
                  RowBox[{"RB", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
               "\[IndentingNewLine]", 
               RowBox[{"(", 
                RowBox[{"alpha", "+", "beta"}], ")"}]}], ")"}], "+", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "^", "2"}], ")"}], "*", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"alpha", "*", 
                    RowBox[{"RA", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                    RowBox[{"beta", "*", 
                    RowBox[{"RB", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"alpha", "+", "beta"}], ")"}]}], ")"}], "-", 
                "\[IndentingNewLine]", 
                RowBox[{"RR", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "recurrence", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eta", "[", 
           RowBox[{"i_", ",", "a_", ",", "0"}], "]"}], ":=", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RA", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"alpha", "*", 
                    RowBox[{"RA", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                   RowBox[{"beta", "*", 
                    RowBox[{"RB", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(", 
                  RowBox[{"alpha", "+", "beta"}], ")"}]}], ")"}], "+", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "^", "2"}], ")"}], "*", "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"alpha", "*", 
                    RowBox[{"RA", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "+", 
                    RowBox[{"beta", "*", 
                    RowBox[{"RB", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"alpha", "+", "beta"}], ")"}]}], ")"}], "-", 
                  RowBox[{"RR", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}]}], "*", 
            RowBox[{"eta", "[", 
             RowBox[{"i", ",", 
              RowBox[{"a", "-", "1"}], ",", "0"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"a", "-", "1"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "*", 
                RowBox[{"(", 
                 RowBox[{"alpha", "+", "beta"}], ")"}]}], ")"}]}], ")"}], "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"t", "^", "2"}]}], ")"}], "*", 
            RowBox[{"eta", "[", 
             RowBox[{"i", ",", 
              RowBox[{"a", "-", "2"}], ",", "0"}], "]"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "xfer", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eta", "[", 
           RowBox[{"i_", ",", "a_", ",", "b_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"eta", "[", 
            RowBox[{"i", ",", 
             RowBox[{"a", "+", "1"}], ",", 
             RowBox[{"b", "-", "1"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"RA", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", 
              RowBox[{"RB", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "*", 
            RowBox[{"eta", "[", 
             RowBox[{"i", ",", "a", ",", 
              RowBox[{"b", "-", "1"}]}], "]"}]}]}]}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"alpha", "+", "beta"}], ")"}], "*", 
              RowBox[{"(", 
               RowBox[{"t", "^", "2"}], ")"}], "*", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"alpha", "*", "RA"}], "+", 
                    RowBox[{"beta", "*", "RB"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"alpha", "+", "beta"}], ")"}]}], ")"}], "-", 
                  "RR"}], ")"}], ".", "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"alpha", "*", "RA"}], "+", 
                    RowBox[{"beta", "*", "RB"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"alpha", "+", "beta"}], ")"}]}], ")"}], "-", 
                  "RR"}], ")"}]}], ")"}]}], ")"}]}], "]"}], 
          RowBox[{"eta", "[", 
           RowBox[{"1", ",", 
            RowBox[{"LA", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"LB", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "*", 
          RowBox[{"eta", "[", 
           RowBox[{"2", ",", 
            RowBox[{"LA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{"LB", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "*", 
          RowBox[{"eta", "[", 
           RowBox[{"3", ",", 
            RowBox[{"LA", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{"LB", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "/.", 
         RowBox[{"t", "->", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "+", "1"}], ")"}], "/", "2"}]}]}], ")"}]}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.868712040902684*^9, 3.868712057501013*^9}, {
  3.868712527282715*^9, 3.8687125705984917`*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"da9355de-b08b-4d65-83fa-70e39848cbfb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.", ",", "1.43233673", ",", 
       RowBox[{"-", "0.9610403"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0.", ",", 
       RowBox[{"-", "1.43233673"}], ",", 
       RowBox[{"-", "0.96104039"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0.", ",", "0.", ",", "0.24026010"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrimCoeff", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.1543289673", ",", "0.5353281423", ",", "0.4446345422"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.1543289673", ",", "0.5353281423", ",", "0.4446345422"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.1543289673", ",", "0.5353281423", ",", "0.4446345422"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.09996722919"}], ",", "0.3995128261", ",", 
        "0.7001154689"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.155916275", ",", "0.6076837186", ",", "0.3919573931"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.155916275", ",", "0.6076837186", ",", "0.3919573931"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.155916275", ",", "0.6076837186", ",", "0.3919573931"}], 
       "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"OrbCoeff", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3.425250914", ",", "0.6239137298", ",", "0.168855404"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"3.425250914", ",", "0.6239137298", ",", "0.168855404"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"130.7093214", ",", "23.80886605", ",", "6.443608313"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"5.033151319", ",", "1.169596125", ",", "0.38038896"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"5.033151319", ",", "1.169596125", ",", "0.38038896"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"5.033151319", ",", "1.169596125", ",", "0.38038896"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"5.033151319", ",", "1.169596125", ",", "0.38038896"}], "}"}]}],
     "\[IndentingNewLine]", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8687120825805387`*^9, 3.868712102634613*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"77e1457b-304d-4ddb-8c9c-05d09ee756f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.43233673`", ",", 
     RowBox[{"-", "0.9610403`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "1.43233673`"}], ",", 
     RowBox[{"-", "0.96104039`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.2402601`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.868712103435898*^9},
 CellLabel->
  "Out[164]=",ExpressionUUID->"91ca1684-fd03-4c77-a608-bd2727790931"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolyX", "[", 
  RowBox[{
   RowBox[{"OrbCoeff", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"OrbCoeff", "[", 
    RowBox[{"[", 
     RowBox[{"7", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"R", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"R", "[", 
    RowBox[{"[", "3", "]"}], "]"}], ",", 
   RowBox[{"R", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"CartAng", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"CartAng", "[", 
    RowBox[{"[", "7", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.868712121856264*^9, 3.8687121447558312`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"4236ef7b-152e-4dff-b0b9-5c77a75e633c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "2.616633736101024`"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], "2"]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "0.486469569516932`"}], "-", 
    RowBox[{"0.17870770762076701`", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8687125807036533`*^9},
 CellLabel->
  "Out[170]=",ExpressionUUID->"9adf742d-627e-44b5-8239-32351948509d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2.616633736101024`"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "0.486469569516932`"}], "-", 
     RowBox[{"0.17870770762076701`", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], "2"]}]}], ")"}]}], " ", "/.", 
  RowBox[{"x", "->", "0"}]}]], "Input",
 CellChangeTimes->{{3.8687121726874957`*^9, 3.8687121851320987`*^9}, 
   3.8687126098141184`*^9},
 CellLabel->
  "In[171]:=",ExpressionUUID->"99e5a43f-d8ab-401a-a963-83094524f347"],

Cell[BoxData[
 RowBox[{"-", "0.0242950510869058`"}]], "Output",
 CellChangeTimes->{3.8687121869045753`*^9, 3.8687126112078977`*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"cd49b0af-8b6c-4bcd-883e-dfb90283aadd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OrbCoeff", "[", 
  RowBox[{"[", 
   RowBox[{"7", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.86871336208178*^9, 3.868713373175398*^9}, {
  3.8687136062076035`*^9, 3.8687136100332985`*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"5d5c31d1-12c2-472e-9d7b-f1c4e91118ce"],

Cell[BoxData["5.033151319`"], "Output",
 CellChangeTimes->{3.8687133737707696`*^9, 3.86871361643991*^9},
 CellLabel->
  "Out[173]=",ExpressionUUID->"9e3ac64e-660d-45ba-b236-a2c92638d183"]
}, Open  ]]
},
WindowSize->{1141.2, 579.6},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4e1b0609-0ee3-4994-a24a-3099e6a60600"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 8440, 216, 466, "Input",ExpressionUUID->"da9355de-b08b-4d65-83fa-70e39848cbfb"],
Cell[CellGroupData[{
Cell[9023, 240, 2647, 71, 333, "Input",ExpressionUUID->"77e1457b-304d-4ddb-8c9c-05d09ee756f8"],
Cell[11673, 313, 504, 14, 32, "Output",ExpressionUUID->"91ca1684-fd03-4c77-a608-bd2727790931"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12214, 332, 738, 21, 28, "Input",ExpressionUUID->"4236ef7b-152e-4dff-b0b9-5c77a75e633c"],
Cell[12955, 355, 596, 18, 48, "Output",ExpressionUUID->"9adf742d-627e-44b5-8239-32351948509d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13588, 378, 716, 21, 45, InheritFromParent,ExpressionUUID->"99e5a43f-d8ab-401a-a963-83094524f347"],
Cell[14307, 401, 214, 4, 32, "Output",ExpressionUUID->"cd49b0af-8b6c-4bcd-883e-dfb90283aadd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14558, 410, 309, 7, 28, "Input",ExpressionUUID->"5d5c31d1-12c2-472e-9d7b-f1c4e91118ce"],
Cell[14870, 419, 187, 3, 55, "Output",ExpressionUUID->"9e3ac64e-660d-45ba-b236-a2c92638d183"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

